
 'Faz a inverção dos dados nas duas primeiras colunas de uma planilha.
 
Sub invertercoluna()
Dim i As Integer
Dim n As Integer

n = Cells(100000, 1).End(xlUp).Row - 1

    For i = 2 To Int(n / 2) + 1
   
        t1 = Cells(i, 1)
        t2 = Cells(i, 2)
        m1 = Cells(n - i + 3, 1)
        m2 = Cells(n - i + 3, 2)
        Cells(n - i + 3, 1) = t1
        Cells(i, 1) = m1
        Cells(n - i + 3, 2) = t2
        Cells(i, 2) = m2
       
    Next i
   
End Sub



'Função que calcula o retorno percentual acumulado de uma série de retornos percentuais.

Function retornopercentual(R As Range) As Single

Dim ret As Single
ret = 1
For Each Cell In R
    ret = ret * (1 + Cell.Value)
Next

retornopercentual = ret - 1

End Function



'Calcula o drawdown máximo de uma série de preços. 


Function drawdown(r As Range) As Single
For Each cell In r
    c = c + 1
Next cell
n = c
ReDim v(c) As Single
For Each cell In r
    i = i + 1
    v(i) = cell
Next cell
Min = v(2) / v(1) - 1
For i = 1 To n - 1
          For j = i + 1 To n
               If v(j) / v(i) - 1 < Min Then
                 Min = v(j) / v(i) - 1
               End If
          Next j
Next i
drawdown = Min
End Function



'Calcula o CAGR de uma série de preços. 



Function cagr(x As Range) As Single
i = 0
For Each cell In x
     If i = 0 Then
        primeira = cell.Value
     End If
     i = i + 1
     ultima = cell.Value
Next

cagr = (ultima / primeira) ^ (1 / (i - 1)) - 1

End Function
